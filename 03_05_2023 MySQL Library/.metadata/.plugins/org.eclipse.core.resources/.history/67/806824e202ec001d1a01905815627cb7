package djuric;

import java.sql.*;

public class Clanovi {

	Connection connection = DatabaseConnection.getConnection();

    public void createClanovi(String ime, String prezime, String datumRodjenja, String mesto, 
    		String ulica, String broj, int telefon) throws SQLException {
        
    	String insert = "INSERT INTO clanovi (ime, prezime, datumRodjenja, mesto, "
        		+ "ulica, broj, telefon) VALUES (?, ?, ?, ?, ?, ?, ?)";
    	
    	PreparedStatement preparedStatement = connection.prepareStatement(insert);
    	
    	preparedStatement.setString(1, ime);
    	preparedStatement.setString(2, prezime);
    	preparedStatement.setString(3, datumRodjenja);
    	preparedStatement.setString(4, mesto);
    	preparedStatement.setString(5, ulica);
    	preparedStatement.setString(6, broj);
    	preparedStatement.setInt(7, telefon);
    	
    	int executeUpdate = preparedStatement.executeUpdate();
    	
    	if(executeUpdate > 0) {
    		System.out.println("Podaci su uspesno uneti! ");
    	}
    	
    	
    	preparedStatement.close();
    }

    public void readClanovi(int clanID) throws SQLException {
        PreparedStatement statement = connection.prepareStatement("SELECT * FROM clanovi WHERE clanID = ?");
        statement.setInt(1, clanID);
        ResultSet rs = statement.executeQuery();
        if (rs.next()) {
            String ime = rs.getString("ime");
            String prezime = rs.getString("prezime");
            String datumRodjenja = rs.getString("datumRodjenja");
            String mesto = rs.getString("mesto");
            String ulica = rs.getString("ulica");
            String broj = rs.getString("broj");
            int telefon = rs.getInt("telefon");
            System.out.println("Clan ID: " + clanID + ", Ime: " + ime + ", Prezime: " + prezime + ", Datum rodjenja: " + datumRodjenja + ", Mesto: " + mesto + ", Ulica: " + ulica + ", Broj: " + broj + ", Telefon: " + telefon);
        }
        rs.close();
        statement.close();
    }

    public void updateClanovi(int clanID, String ime, String prezime, String datumRodjenja, String mesto, String ulica, String broj, int telefon) throws SQLException {
        PreparedStatement statement = connection.prepareStatement("UPDATE clanovi SET ime = ?, prezime = ?, datumRodjenja = ?, mesto = ?, ulica = ?, broj = ?, telefon = ? WHERE clanID = ?");
        statement.setString(1, ime);
        statement.setString(2, prezime);
        statement.setString(3, datumRodjenja);
        statement.setString(4, mesto);
        statement.setString(5, ulica);
        statement.setString(6, broj);
        statement.setInt(7, telefon);
        statement.setInt(8, clanID);
        int rowsUpdated = statement.executeUpdate();
        if (rowsUpdated > 0) {
            System.out.println("Clan ID " + clanID + " updated successfully.");
        } else {
            System.out.println("Clan ID " + clanID + " not found.");
        }
        statement.close();
    }

    public void deleteClanovi(int clanID) throws SQLException {
        PreparedStatement statement = connection.prepareStatement("DELETE FROM clanovi WHERE clanID = ?");
        statement.setInt(1, clanID);
        int rowsDeleted = statement.executeUpdate();

}
